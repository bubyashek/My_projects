(()=>{"use strict";var n,e={849:()=>{var n=function(n,e,t,o){return new(t||(t=Promise))(function(i,r){function s(n){try{a(o.next(n))}catch(n){r(n)}}function d(n){try{a(o.throw(n))}catch(n){r(n)}}function a(n){var e;n.done?i(n.value):(e=n.value,e instanceof t?e:new t(function(n){n(e)})).then(s,d)}a((o=o.apply(n,e||[])).next())})};const e="/api";function t(e,t){return n(this,void 0,void 0,function*(){try{const n=yield fetch(e,Object.assign(Object.assign({},t),{headers:Object.assign({"Content-Type":"application/json"},null==t?void 0:t.headers)}));if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);return yield n.json()}catch(n){throw console.error("Fetch error:",n),n}})}const o=()=>t(`${e}/users`),i=n=>t(`${e}/users/${n}`),r=n=>t(`${e}/users/${n}/friends`),s=(n,o)=>t(`${e}/users/${n}/friends`,{method:"POST",body:JSON.stringify({friendId:o})}),d=(n,o)=>t(`${e}/users/${n}/friends/${o}`,{method:"DELETE"}),a=(n,e="success")=>{const t="error"===e?"danger":e,o=document.createElement("div");o.className=`alert alert-${t} alert-dismissible fade show position-fixed top-0 start-50 translate-middle-x mt-3`,o.style.zIndex="9999",o.innerHTML=`\n    ${n}\n    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>\n  `,document.body.appendChild(o),setTimeout(()=>{o.remove()},3e3)},c=n=>{const e=[n.lastName,n.firstName];return n.middleName&&e.push(n.middleName),e.join(" ")};let l,u=null;const m=n=>new Promise(e=>{(()=>{var n,e,t;if(l)return;document.getElementById("confirmModal")||document.body.insertAdjacentHTML("beforeend",'\n    <div class="modal fade" id="confirmModal" tabindex="-1">\n      <div class="modal-dialog modal-dialog-centered">\n        <div class="modal-content confirm-modal-content">\n          <div class="modal-header confirm-modal-header">\n            <h5 class="modal-title">\n              <i class="fas fa-exclamation-triangle me-2"></i>\n              Подтверждение действия\n            </h5>\n          </div>\n          <div class="modal-body confirm-modal-body">\n            <p id="confirmModalMessage"></p>\n          </div>\n          <div class="modal-footer confirm-modal-footer">\n            <button type="button" class="btn btn-secondary" id="confirmModalCancel">\n              <i class="fas fa-times me-2"></i>\n              Отмена\n            </button>\n            <button type="button" class="btn btn-danger" id="confirmModalConfirm">\n              <i class="fas fa-check me-2"></i>\n              Подтвердить\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  '),void 0!==window.bootstrap&&(l=new window.bootstrap.Modal(document.getElementById("confirmModal"))),null===(n=document.getElementById("confirmModalCancel"))||void 0===n||n.addEventListener("click",()=>{null==l||l.hide(),u&&(u(!1),u=null)}),null===(e=document.getElementById("confirmModalConfirm"))||void 0===e||e.addEventListener("click",()=>{null==l||l.hide(),u&&(u(!0),u=null)}),null===(t=document.getElementById("confirmModal"))||void 0===t||t.addEventListener("hidden.bs.modal",()=>{u&&(u(!1),u=null)})})();const t=document.getElementById("confirmModalMessage");t&&(t.textContent=n),u=e,null==l||l.show()});var f=function(n,e,t,o){return new(t||(t=Promise))(function(i,r){function s(n){try{a(o.next(n))}catch(n){r(n)}}function d(n){try{a(o.throw(n))}catch(n){r(n)}}function a(n){var e;n.done?i(n.value):(e=n.value,e instanceof t?e:new t(function(n){n(e)})).then(s,d)}a((o=o.apply(n,e||[])).next())})};let v,h,w=[],b=[];const p=()=>f(void 0,void 0,void 0,function*(){try{const n=window.location.pathname.split("/");if(v=parseInt(n[n.length-1]),isNaN(v))return void a("Неверный ID пользователя","error");yield y(),yield $(),yield g(),h=new bootstrap.Modal(document.getElementById("addFriendModal")),L()}catch(n){console.error("Initialization error:",n),a("Ошибка инициализации страницы","error")}}),y=()=>f(void 0,void 0,void 0,function*(){try{const n=yield i(v),e=document.getElementById("user-name");e&&(e.textContent=`Друзья пользователя: ${c(n)}`)}catch(n){console.error("Error loading user:",n),a("Ошибка загрузки информации о пользователе","error")}}),g=()=>f(void 0,void 0,void 0,function*(){try{b=yield o()}catch(n){console.error("Error loading users:",n)}}),$=()=>f(void 0,void 0,void 0,function*(){const n=document.getElementById("friends-container");if(n)try{w=yield r(v),E(w)}catch(e){console.error("Error loading friends:",e),n.innerHTML='<div class="alert alert-danger">Ошибка загрузки списка друзей</div>'}}),E=n=>{const e=document.getElementById("friends-container");e&&(0!==n.length?e.innerHTML=n.map(n=>`\n    <div class="friend-card" data-status="${n.status}">\n      <img src="${n.photo}" alt="${c(n)}" class="friend-avatar">\n      <div class="friend-info">\n        <div class="friend-name">${c(n)}</div>\n        <div class="friend-email">\n          <i class="fas fa-envelope"></i> ${n.email}\n        </div>\n        <div class="friend-badges">\n          <span class="badge-status ${n.status}">${M(n.status)}</span>\n        </div>\n      </div>\n      <div class="friend-actions">\n        <button class="btn btn-success btn-sm" onclick="viewNews(${n.id})">\n          <i class="fas fa-newspaper"></i> Новости\n        </button>\n        <button class="btn btn-danger btn-sm" onclick="removeFriend(${n.id})">\n          <i class="fas fa-user-times"></i> Удалить\n        </button>\n      </div>\n    </div>\n  `).join(""):e.innerHTML='<div class="alert alert-info">У этого пользователя пока нет друзей</div>')},M=n=>({active:"Активный",blocked:"Заблокирован",unconfirmed:"Не подтверждён"}[n]||n),k=()=>{const n=document.getElementById("searchFriend"),e=(null==n?void 0:n.value.toLowerCase())||"",t=document.getElementById("available-users");if(!t)return;if(e.length<2)return void(t.innerHTML='<p class="text-muted">Введите минимум 2 символа для поиска...</p>');const o=w.map(n=>n.id),i=b.filter(n=>{if(n.id===v)return!1;if(o.includes(n.id))return!1;const t=c(n).toLowerCase(),i=n.email.toLowerCase();return t.includes(e)||i.includes(e)});0!==i.length?t.innerHTML=i.map(n=>`\n    <div class="user-search-item">\n      <img src="${n.photo}" alt="${c(n)}" class="user-search-avatar">\n      <div class="user-search-info">\n        <div class="user-search-name">${c(n)}</div>\n        <div class="user-search-email">${n.email}</div>\n      </div>\n      <button class="btn btn-primary btn-sm" onclick="addFriend(${n.id})">\n        <i class="fas fa-plus"></i> Добавить\n      </button>\n    </div>\n  `).join(""):t.innerHTML='<p class="text-muted">Пользователи не найдены</p>'},I=n=>f(void 0,void 0,void 0,function*(){try{yield s(v,n),a("Друг успешно добавлен","success"),h.hide(),document.getElementById("searchFriend").value="",document.getElementById("available-users").innerHTML='<p class="text-muted">Начните вводить для поиска пользователей...</p>',yield $()}catch(n){console.error("Error adding friend:",n),a("Ошибка добавления друга","error")}}),x=n=>f(void 0,void 0,void 0,function*(){if(yield m("Вы уверены, что хотите удалить этого друга?"))try{yield d(v,n),a("Друг успешно удалён","success"),yield $()}catch(n){console.error("Error removing friend:",n),a("Ошибка удаления друга","error")}}),L=()=>{window.searchUsers=k,window.addFriend=I,window.removeFriend=x,window.goBackToUsers=()=>{const n=window.location.pathname.includes("webpack");window.location.href=n?"/webpack-users":"/users"},window.viewFriends=n=>{const e=window.location.pathname.includes("webpack");window.location.href=e?`/webpack-friends/${n}`:`/friends/${n}`},window.viewNews=n=>{const e=window.location.pathname.includes("webpack");window.location.href=e?`/webpack-news/${n}`:`/news/${n}`}};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",p):p()}},t={};function o(n){var i=t[n];if(void 0!==i)return i.exports;var r=t[n]={exports:{}};return e[n](r,r.exports,o),r.exports}o.m=e,n=[],o.O=(e,t,i,r)=>{if(!t){var s=1/0;for(l=0;l<n.length;l++){for(var[t,i,r]=n[l],d=!0,a=0;a<t.length;a++)(!1&r||s>=r)&&Object.keys(o.O).every(n=>o.O[n](t[a]))?t.splice(a--,1):(d=!1,r<s&&(s=r));if(d){n.splice(l--,1);var c=i();void 0!==c&&(e=c)}}return e}r=r||0;for(var l=n.length;l>0&&n[l-1][2]>r;l--)n[l]=n[l-1];n[l]=[t,i,r]},o.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e),(()=>{var n={814:0,177:0};o.O.j=e=>0===n[e];var e=(e,t)=>{var i,r,[s,d,a]=t,c=0;if(s.some(e=>0!==n[e])){for(i in d)o.o(d,i)&&(o.m[i]=d[i]);if(a)var l=a(o)}for(e&&e(t);c<s.length;c++)r=s[c],o.o(n,r)&&n[r]&&n[r][0](),n[r]=0;return o.O(l)},t=self.webpackChunksocial_network_lab3_etu_2=self.webpackChunksocial_network_lab3_etu_2||[];t.forEach(e.bind(null,0)),t.push=e.bind(null,t.push.bind(t))})();var i=o.O(void 0,[177],()=>o(849));i=o.O(i)})();
//# sourceMappingURL=friends.bundle.js.map
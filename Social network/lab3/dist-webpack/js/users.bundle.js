(()=>{"use strict";var e,t={636:()=>{var e=function(e,t,n,d){return new(n||(n=Promise))(function(o,a){function i(e){try{r(d.next(e))}catch(e){a(e)}}function l(e){try{r(d.throw(e))}catch(e){a(e)}}function r(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(i,l)}r((d=d.apply(e,t||[])).next())})};const t="/api";function n(t,n){return e(this,void 0,void 0,function*(){try{const e=yield fetch(t,Object.assign(Object.assign({},n),{headers:Object.assign({"Content-Type":"application/json"},null==n?void 0:n.headers)}));if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return yield e.json()}catch(e){throw console.error("Fetch error:",e),e}})}const d=()=>n(`${t}/users`),o=e=>n(`${t}/users`,{method:"POST",body:JSON.stringify(e)}),a=(e,d)=>n(`${t}/users/${e}`,{method:"PUT",body:JSON.stringify(d)}),i=e=>n(`${t}/users/${e}`,{method:"DELETE"}),l=(e,t="success")=>{const n="error"===t?"danger":t,d=document.createElement("div");d.className=`alert alert-${n} alert-dismissible fade show position-fixed top-0 start-50 translate-middle-x mt-3`,d.style.zIndex="9999",d.innerHTML=`\n    ${e}\n    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>\n  `,document.body.appendChild(d),setTimeout(()=>{d.remove()},3e3)},r=e=>{const t=[e.lastName,e.firstName];return e.middleName&&t.push(e.middleName),t.join(" ")};let s,c=null;const u=e=>new Promise(t=>{(()=>{var e,t,n;if(s)return;document.getElementById("confirmModal")||document.body.insertAdjacentHTML("beforeend",'\n    <div class="modal fade" id="confirmModal" tabindex="-1">\n      <div class="modal-dialog modal-dialog-centered">\n        <div class="modal-content confirm-modal-content">\n          <div class="modal-header confirm-modal-header">\n            <h5 class="modal-title">\n              <i class="fas fa-exclamation-triangle me-2"></i>\n              Подтверждение действия\n            </h5>\n          </div>\n          <div class="modal-body confirm-modal-body">\n            <p id="confirmModalMessage"></p>\n          </div>\n          <div class="modal-footer confirm-modal-footer">\n            <button type="button" class="btn btn-secondary" id="confirmModalCancel">\n              <i class="fas fa-times me-2"></i>\n              Отмена\n            </button>\n            <button type="button" class="btn btn-danger" id="confirmModalConfirm">\n              <i class="fas fa-check me-2"></i>\n              Подтвердить\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  '),void 0!==window.bootstrap&&(s=new window.bootstrap.Modal(document.getElementById("confirmModal"))),null===(e=document.getElementById("confirmModalCancel"))||void 0===e||e.addEventListener("click",()=>{null==s||s.hide(),c&&(c(!1),c=null)}),null===(t=document.getElementById("confirmModalConfirm"))||void 0===t||t.addEventListener("click",()=>{null==s||s.hide(),c&&(c(!0),c=null)}),null===(n=document.getElementById("confirmModal"))||void 0===n||n.addEventListener("hidden.bs.modal",()=>{c&&(c(!1),c=null)})})();const n=document.getElementById("confirmModalMessage");n&&(n.textContent=e),c=t,null==s||s.show()});var m=function(e,t,n,d){return new(n||(n=Promise))(function(o,a){function i(e){try{r(d.next(e))}catch(e){a(e)}}function l(e){try{r(d.throw(e))}catch(e){a(e)}}function r(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(i,l)}r((d=d.apply(e,t||[])).next())})};let v,f,y=[],g=[];const h=()=>m(void 0,void 0,void 0,function*(){try{yield b(),I(),k(),v=new bootstrap.Modal(document.getElementById("editUserModal")),f=new bootstrap.Modal(document.getElementById("addUserModal"))}catch(e){console.error("Initialization error:",e),l("Ошибка инициализации страницы","error")}}),b=()=>m(void 0,void 0,void 0,function*(){const e=document.getElementById("users-container");if(e)try{y=yield d(),g=[...y],E(g)}catch(t){console.error("Error loading users:",t),e.innerHTML='<div class="alert alert-danger">Ошибка загрузки пользователей</div>'}}),E=e=>{const t=document.getElementById("users-container");if(!t)return;if(0===e.length)return void(t.innerHTML='<div class="alert alert-info">Пользователей не найдено</div>');const n=(e=>[...e].sort((e,t)=>{var n,d,o,a;const i={admin:0,user:1},l=null!==(n=i[e.role])&&void 0!==n?n:2,r=null!==(d=i[t.role])&&void 0!==d?d:2;if(l!==r)return l-r;const s={active:0,unconfirmed:1,blocked:2};return(null!==(o=s[e.status])&&void 0!==o?o:3)-(null!==(a=s[t.status])&&void 0!==a?a:3)}))(e);t.innerHTML=n.map(e=>{return`\n    <div class="user-card" data-user-id="${e.id}" data-status="${e.status}">\n      <img src="${e.photo}" alt="${r(e)}" class="user-avatar">\n      <div class="user-info">\n        <div class="user-name">${r(e)}</div>\n        <div class="user-email">\n          <i class="fas fa-envelope"></i> ${e.email}\n        </div>\n        <div class="user-birth">\n          <i class="fas fa-birthday-cake"></i> Дата рождения: ${d=e.dateOfBirth,new Date(d).toLocaleDateString("ru-RU",{year:"numeric",month:"long",day:"numeric"})}\n        </div>\n        <div class="user-badges">\n          <span class="badge-role ${e.role}">${n=e.role,{admin:"Администратор",user:"Пользователь"}[n]||n}</span>\n          <span class="badge-status ${e.status}">${t=e.status,{active:"Активный",blocked:"Заблокирован",unconfirmed:"Не подтверждён"}[t]||t}</span>\n        </div>\n      </div>\n      <div class="user-actions">\n        <button class="btn btn-primary btn-edit" data-user-id="${e.id}">\n          <i class="fas fa-edit"></i> Редактировать\n        </button>\n        <button class="btn btn-info" onclick="viewFriends(${e.id})">\n          <i class="fas fa-user-friends"></i> Друзья\n        </button>\n        <button class="btn btn-success" onclick="viewNews(${e.id})">\n          <i class="fas fa-newspaper"></i> Новости\n        </button>\n        <button class="btn btn-danger btn-delete" data-user-id="${e.id}">\n          <i class="fas fa-trash-alt"></i> Удалить\n        </button>\n      </div>\n    </div>\n  `;var t,n,d}).join(""),p()},p=()=>{document.querySelectorAll(".btn-edit").forEach(e=>{e.addEventListener("click",e=>{const t=parseInt(e.target.dataset.userId||"0");w(t)})}),document.querySelectorAll(".btn-delete").forEach(e=>{e.addEventListener("click",e=>m(void 0,void 0,void 0,function*(){const t=parseInt(e.target.dataset.userId||"0");yield N(t)}))})},w=e=>{const t=y.find(t=>t.id===e);t&&(document.getElementById("editUserId").value=t.id.toString(),document.getElementById("editFirstName").value=t.firstName,document.getElementById("editLastName").value=t.lastName,document.getElementById("editMiddleName").value=t.middleName,document.getElementById("editEmail").value=t.email,document.getElementById("editDateOfBirth").value=t.dateOfBirth,document.getElementById("editRole").value=t.role,document.getElementById("editStatus").value=t.status,document.getElementById("editPhoto").value=t.photo,v.show())},I=()=>{const e=document.getElementById("editUserForm");e&&e.addEventListener("submit",e=>m(void 0,void 0,void 0,function*(){e.preventDefault(),yield $()}));const t=document.getElementById("addUserForm");t&&t.addEventListener("submit",e=>m(void 0,void 0,void 0,function*(){e.preventDefault(),yield B()}))},B=()=>m(void 0,void 0,void 0,function*(){const e={firstName:document.getElementById("addFirstName").value,lastName:document.getElementById("addLastName").value,middleName:document.getElementById("addMiddleName").value,email:document.getElementById("addEmail").value,dateOfBirth:document.getElementById("addDateOfBirth").value,role:document.getElementById("addRole").value,status:document.getElementById("addStatus").value,photo:document.getElementById("addPhoto").value};try{yield o(e),l("Пользователь успешно добавлен","success"),f.hide(),document.getElementById("addUserForm").reset(),yield b()}catch(e){console.error("Error creating user:",e),l("Ошибка добавления пользователя","error")}}),$=()=>m(void 0,void 0,void 0,function*(){const e=parseInt(document.getElementById("editUserId").value),t={firstName:document.getElementById("editFirstName").value,lastName:document.getElementById("editLastName").value,middleName:document.getElementById("editMiddleName").value,email:document.getElementById("editEmail").value,dateOfBirth:document.getElementById("editDateOfBirth").value,role:document.getElementById("editRole").value,status:document.getElementById("editStatus").value,photo:document.getElementById("editPhoto").value};try{yield a(e,t),l("Пользователь успешно обновлён","success"),v.hide(),yield b()}catch(e){console.error("Error updating user:",e),l("Ошибка обновления пользователя","error")}}),N=e=>m(void 0,void 0,void 0,function*(){if(yield u("Вы уверены, что хотите удалить этого пользователя?"))try{yield i(e),l("Пользователь успешно удалён","success"),yield b()}catch(e){console.error("Error deleting user:",e),l("Ошибка удаления пользователя","error")}});window.viewFriends=e=>{const t=window.location.pathname.includes("webpack");window.location.href=t?`/webpack-friends/${e}`:`/friends/${e}`},window.viewNews=e=>{const t=window.location.pathname.includes("webpack");window.location.href=t?`/webpack-news/${e}`:`/news/${e}`};const M=()=>{var e,t,n;const d=(null===(e=document.getElementById("filterRole"))||void 0===e?void 0:e.value)||"",o=(null===(t=document.getElementById("filterStatus"))||void 0===t?void 0:t.value)||"",a=(null===(n=document.getElementById("filterSearch"))||void 0===n?void 0:n.value.toLowerCase())||"";g=y.filter(e=>{if(d&&e.role!==d)return!1;if(o&&e.status!==o)return!1;if(a){const t=r(e).toLowerCase(),n=e.email.toLowerCase();if(!t.includes(a)&&!n.includes(a))return!1}return!0}),E(g)},O=()=>{const e=document.getElementById("filterRole"),t=document.getElementById("filterStatus"),n=document.getElementById("filterSearch");e&&(e.value=""),t&&(t.value=""),n&&(n.value=""),g=[...y],E(g)},k=()=>{window.applyFilters=M,window.clearFilters=O};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",h):h()}},n={};function d(e){var o=n[e];if(void 0!==o)return o.exports;var a=n[e]={exports:{}};return t[e](a,a.exports,d),a.exports}d.m=t,e=[],d.O=(t,n,o,a)=>{if(!n){var i=1/0;for(c=0;c<e.length;c++){for(var[n,o,a]=e[c],l=!0,r=0;r<n.length;r++)(!1&a||i>=a)&&Object.keys(d.O).every(e=>d.O[e](n[r]))?n.splice(r--,1):(l=!1,a<i&&(i=a));if(l){e.splice(c--,1);var s=o();void 0!==s&&(t=s)}}return t}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[n,o,a]},d.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={809:0,177:0};d.O.j=t=>0===e[t];var t=(t,n)=>{var o,a,[i,l,r]=n,s=0;if(i.some(t=>0!==e[t])){for(o in l)d.o(l,o)&&(d.m[o]=l[o]);if(r)var c=r(d)}for(t&&t(n);s<i.length;s++)a=i[s],d.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return d.O(c)},n=self.webpackChunksocial_network_lab3_etu_2=self.webpackChunksocial_network_lab3_etu_2||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var o=d.O(void 0,[177],()=>d(636));o=d.O(o)})();
//# sourceMappingURL=users.bundle.js.map